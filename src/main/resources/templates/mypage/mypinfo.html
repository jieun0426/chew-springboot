<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <meta charset="UTF-8">
    <title>íšŒì›ì •ë³´ ìˆ˜ì •</title>
    <link rel="stylesheet" th:href="@{/css/mypageup.css}">
    <link rel="stylesheet" th:href="@{/css/mypagemenu.css}">
</head>
<body>
<section layout:fragment="content">
<div class="div-container">
    <div class="category">
        <h1>ë§ˆì´í˜ì´ì§€</h1>
        <nav>
            <ul>
                <li><a href="mypinfo" class="menulink active">íšŒì›ì •ë³´ ìˆ˜ì •</a></li>
                <li><a href="mypagebook" class="menulink">ì˜ˆì•½ë‚´ì—­</a></li>
                <li><a href="mypagereview" class="menulink">ì‘ì„±í•œ ë¦¬ë·°</a></li>
                <li><a href="mypagedel" class="menulink">íšŒì›íƒˆí‡´</a></li>
            </ul>
        </nav>
    </div>



    <form name="f" class="form" th:action="@{/myinfosave}" th:object="${updateMemberDTO}" method="post" onsubmit="return send_go()">
        <div id="heading">íšŒì›ì •ë³´ ìˆ˜ì •</div>



        <script th:inline="javascript">
            /*<![CDATA[*/
            var alertMessage = /*[[${alertMessage}]]*/ null;
            if (alertMessage) {
                alert(alertMessage);
            }
            /*]]>*/
        </script>

        <!-- ID -->
        <label class="required-label">ID</label>
        <div class="field">
            <input class="input-field" type="text" th:field="*{id}" readonly>
        </div>

        <!-- ì´ë¦„ -->
        <label class="required-label">ì´ë¦„</label>
        <div class="field">
            <input class="input-field" type="text" th:field="*{name}" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
        </div>
        <p th:if="${#fields.hasErrors('name')}" th:errors="*{name}" class="field-error"></p>

        <!-- ì „í™”ë²ˆí˜¸ -->
        <label class="required-label">ì „í™”ë²ˆí˜¸</label>
        <div class="field">
            <input class="input-field" type="text" th:field="*{phone}" placeholder="ì˜ˆ: 010-1234-5678">
        </div>
        <p th:if="${#fields.hasErrors('phone')}" th:errors="*{phone}" class="field-error"></p>

        <!-- ìƒë…„ì›”ì¼ -->
        <label class="required-label">ìƒë…„ì›”ì¼</label>
        <div class="field">
            <select id="birthYear" required>
                <option value="" disabled th:selected="${updateMemberDTO.birth == null}">ë…„ë„</option>
                <option th:each="y : ${#numbers.sequence(2025, 1900, -1)}" th:value="${y}" th:text="${y}"></option>
            </select> ë…„ &ensp;

            <select id="birthMonth" required>
                <option value="" disabled th:selected="${updateMemberDTO.birth == null}">ì›”</option>
                <option th:each="m : ${#numbers.sequence(1, 12)}" th:value="${m}" th:text="${m}"></option>
            </select> ì›” &ensp;

            <select id="birthDay" required>
                <option value="" disabled th:selected="${updateMemberDTO.birth == null}">ì¼</option>
                <option th:each="d : ${#numbers.sequence(1, 31)}" th:value="${d}" th:text="${d}"></option>
            </select> ì¼

            <input type="hidden" th:field="*{birth}" id="birth" />
        </div>
        <p th:if="${#fields.hasErrors('birth')}" th:errors="*{birth}" class="field-error"></p>

        <br>
        <button id="loginButton" class="button login-btn" type="submit">ìˆ˜ì •ì™„ë£Œ</button>
    </form>
</div>

<!-- ìƒë…„ì›”ì¼ ì²˜ë¦¬ -->
<script th:inline="javascript">
    /*<![CDATA[*/
    const birth = /*[[${updateMemberDTO.birth}]]*/ '';
    /*]]>*/

    window.onload = function () {
        if (birth) {
            const parts = birth.split('-');
            if (parts.length === 3) {
                document.getElementById("birthYear").value = parts[0];
                document.getElementById("birthMonth").value = parseInt(parts[1], 10);
                document.getElementById("birthDay").value = parseInt(parts[2], 10);
            }
        }
    }

    function send_go() {
        const y = document.getElementById("birthYear").value;
        const m = document.getElementById("birthMonth").value.padStart(2, '0');
        const d = document.getElementById("birthDay").value.padStart(2, '0');

        if (!y || !m || !d) {
            alert("ìƒë…„ì›”ì¼ì„ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.");
            return false;
        }

        const fullBirth = `${y}-${m}-${d}`;
        document.getElementById("birth").value = fullBirth;
        console.log("ğŸ“Œ ìµœì¢… ìƒì¼ ê°’:", fullBirth);
        return true;
    }
</script>
<br>
</body>
</html>
